## Ystar直播

### 项目描述: 基于Netty搭建的自研IM服务器，设计特定路由转发功能实现多客户端通信，自定义分布式唯一ID生成器，根据压力模型拆解服务边界，实现了使用消息队列异步优化消息向下游服务传递，功能包括消息互发、直播打赏、主播PK等。

### 技术栈：SpringCloud、Netty、Dubbo、RabbitMQ、Redis等
- 通过ThreadLocal配合拦截器保存当前用户信息，并封装工具类简化操作，极大简化获取用户信息的操作
- 基于数据库号段模式自定义分布式唯一ID生成器，使用 CAS + 版本号机制解决号段重复加载问题
- 实现推拉模式、针对在线和离线用户都有获取直播间全程消息的能力
- 运用策略、工厂、单例模式，对不同类型的客户端消息编写不同的Handler，降低代码耦合度，并提高项目的可维护性与易选代性
- 扩展 Dubbo SPI 机制，实现用户消息向特定的 IM 服务器转发，避免消息风暴，提高 IM 的可靠性
- 使用线程池技术，将串行打赏优化为并行多线程执行，提高了50%的评测速度
- 搭建 MySQL 主从集群，使用延迟双删解决主从数据不一致问题
- 针对多处先查缓存再改数据如余额，PK进度条等，通过分布式锁和Lua脚本保证俩个操作的原子性
